---
// Header.astro - Logo, Brand, Tabs, Call Now, Open - Each in Their Own Card
import { siteConfig } from '../config';
---

<header
  class="cosmic-header"
  style="position:relative; background:linear-gradient(135deg,rgba(15,23,42,0.95),rgba(30,41,59,0.9)); backdrop-filter:blur(20px); border-bottom:2px solid rgba(6,182,212,0.3); z-index:1000;"
>
  <!-- Cosmic Background Effects -->
  <div
    class="header-cosmic-bg"
    style="position:absolute; top:0; left:0; right:0; bottom:0; overflow:hidden; pointer-events:none;"
  >
    <div
      style="position:absolute; top:-50%; left:-50%; width:200%; height:200%; background:radial-gradient(circle,rgba(6,182,212,0.1) 0%, transparent 70%); animation:cosmic-rotate 20s linear infinite;"
    >
    </div>
    <div
      style="position:absolute; top:20%; right:10%; width:100px; height:100px; background:radial-gradient(circle,rgba(139,92,246,0.15) 0%, transparent 70%); border-radius:50%; animation:float-cosmic 4s ease-in-out infinite;"
    >
    </div>
    <div
      style="position:absolute; bottom:30%; left:15%; width:80px; height:80px; background:radial-gradient(circle,rgba(16,185,129,0.12) 0%, transparent 70%); border-radius:50%; animation:float-cosmic 3s ease-in-out infinite reverse;"
    >
    </div>
  </div>

  <!-- Emergency Contact Bar -->
  <div
    style="background:linear-gradient(45deg,rgba(220,38,38,0.15),rgba(245,158,11,0.15)); border-bottom:1px solid rgba(220,38,38,0.3); padding:8px; text-align:center; animation:emergencyPulse 3s ease-in-out infinite;"
  >
    <p
      class="tech-font"
      style="color:var(--solar-orange); font-size:11px; margin:0; font-weight:600; position:relative; z-index:2;"
    >
      ğŸš¨ <span style="color:var(--aurora-green);">EMERGENCY REPAIRS?</span>
      Call <a
        href={`tel:${siteConfig.phone.mobile}`}
        style="color:var(--aurora-green); font-weight:bold; text-decoration:none;"
        >{siteConfig.phone.mobileDisplay}</a
      >
      ğŸš¨
    </p>
  </div>

  <div class="container" style="position:relative; z-index:2; padding:16px 20px;">
    <div
      class="header-toolbar"
      style="display:flex; align-items:center; justify-content:space-between; gap:16px; flex-wrap:wrap;"
    >
      <!-- Logo Image Card -->
      <div
        class="cosmic-card logo-image-card"
        style="padding:12px 16px; background:linear-gradient(145deg, rgba(248,250,252,0.95), rgba(226,232,240,0.9)); border-radius:12px; display:flex; align-items:center; justify-content:center; min-width:58px; position:relative; overflow:hidden; border:2px solid rgba(6,182,212,0.4); box-shadow:0 4px 20px rgba(6,182,212,0.3);"
      >
        <!-- shimmer overlay, z-index: 1 -->
        <div
          style="position:absolute; inset:0; background:linear-gradient(45deg,transparent,rgba(6,182,212,0.15),transparent); animation:shimmer 10s ease-in-out infinite; z-index:1; pointer-events:none;"
        >
        </div>
        <!-- logo image, z-index:2 -->
        <img
          src="/logo_homepage.webp"
          alt="Chiltern Computers Logo"
          width="132"
          height="75"
          style="height:75px; width:auto; display:block; position:relative; z-index:2;"
        />
      </div>

      <!-- Mobile Menu Toggle (hidden desktop, shown mobile) -->
      <div class="mobile-menu-toggle" style="display:none; position:relative;">
        <button
          id="mobile-menu-btn"
          class="space-button"
          style="padding:10px 16px; font-size:14px; border:2px solid var(--plasma-cyan); background:rgba(6,182,212,0.1); color:var(--starlight-white); border-radius:8px; font-weight:600; transition:all 0.3s ease;"
          aria-label="Toggle navigation menu"
          aria-expanded="false"
          aria-controls="main-nav"
        >
          <span id="menu-text">Menu</span>
        </button>
      </div>

      <!-- Navigation Tabs (Center, hidden on mobile/tablet until toggled) -->
      <nav
        class="header-nav"
        id="main-nav"
        style="flex:1 1 0; display:flex; justify-content:center; min-width:210px;"
      >
        <ul
          class="nav-list"
          style="list-style:none; padding:0; margin:0; display:flex; gap:8px; justify-content:center; flex-wrap:wrap;"
        >
          <li>
            <a
              href="/"
              class="nav-link space-button"
              aria-label="Go to homepage"
              style="padding:8px 16px; font-size:12px; text-decoration:none; border:1px solid var(--plasma-cyan); background:rgba(6,182,212,0.1); transition:all 0.3s ease; display:flex; align-items:center; gap:6px;"
              ><span aria-hidden="true">ğŸ </span>Home</a
            >
          </li>
          <li>
            <a
              href="/services/custom-pcs/"
              class="nav-link space-button"
              aria-label="Custom gaming PC builds"
              style="padding:8px 16px; font-size:12px; text-decoration:none; border:1px solid var(--aurora-green); background:rgba(16,185,129,0.1); transition:all 0.3s ease; display:flex; align-items:center; gap:6px;"
              ><span aria-hidden="true">ğŸ®</span>Gaming PCs</a
            >
          </li>
          <li>
            <a
              href="/services/repairs/"
              class="nav-link space-button"
              aria-label="Computer repair services"
              style="padding:8px 16px; font-size:12px; text-decoration:none; border:1px solid var(--solar-orange); background:rgba(245,158,11,0.1); transition:all 0.3s ease; display:flex; align-items:center; gap:6px;"
              ><span aria-hidden="true">ğŸ› ï¸</span>Repairs</a
            >
          </li>
          <li>
            <a
              href="/services/new-used/"
              class="nav-link space-button"
              aria-label="New and refurbished computers"
              style="padding:8px 16px; font-size:12px; text-decoration:none; border:1px solid var(--nebula-purple); background:rgba(139,92,246,0.1); transition:all 0.3s ease; display:flex; align-items:center; gap:6px;"
              ><span aria-hidden="true">ğŸ’»</span>PCs & Laptops</a
            >
          </li>
          <li>
            <a
              href="/about/"
              class="nav-link space-button"
              aria-label="About Chiltern Computers"
              style="padding:8px 16px; font-size:12px; text-decoration:none; border:1px solid var(--plasma-cyan); background:rgba(6,182,212,0.1); transition:all 0.3s ease; display:flex; align-items:center; gap:6px;"
              ><span aria-hidden="true">â„¹ï¸</span>About</a
            >
          </li>
          <li>
            <a
              href="/blog/"
              class="nav-link space-button"
              aria-label="Computer repair tips and blog"
              style="padding:8px 16px; font-size:12px; text-decoration:none; border:1px solid var(--plasma-cyan); background:rgba(6,182,212,0.1); transition:all 0.3s ease; display:flex; align-items:center; gap:6px;"
              ><span aria-hidden="true">ğŸ“</span>Blog</a
            >
          </li>
          <li>
            <a
              href="/contact/"
              class="nav-link space-button cta-primary"
              aria-label="Contact us for repairs"
              style="padding:8px 16px; font-size:12px; text-decoration:none; background:linear-gradient(45deg, var(--aurora-green), var(--plasma-cyan)) !important; border:2px solid var(--aurora-green); font-weight:600; text-transform:uppercase; letter-spacing:0.5px; display:flex; align-items:center; gap:6px;"
              ><span aria-hidden="true">ğŸ“</span>Contact</a
            >
          </li>
        </ul>
      </nav>

      <!-- Contact Info (Right) -->
      <div style="display:flex; align-items:center; gap:12px; flex-wrap:wrap;">
        <a
          href="tel:+447971331814"
          class="cosmic-card contact-link-premium"
          aria-label="Call Now 07971 331814"
          style="padding:10px 16px; background:rgba(139,92,246,0.15); border:2px solid var(--nebula-purple); border-radius:10px; text-decoration:none; display:flex; align-items:center; gap:8px; transition:all 0.3s ease; position:relative; overflow:hidden;"
        >
          <div
            class="premium-glow-effect"
            style="position:absolute; inset:0; background:linear-gradient(45deg, transparent, rgba(139,92,246,0.3), transparent); opacity:0; transition:opacity 0.3s ease;"
          >
          </div>
          <span style="font-size:16px; position:relative; z-index:2;">ğŸ“±</span>
          <div style="position:relative; z-index:2;">
            <div class="tech-font" style="color:var(--comet-silver); font-size:10px;">CALL NOW</div>
            <div
              class="alien-font"
              style="color:var(--starlight-white); font-size:13px; font-weight:600;"
            >
              07971 331814
            </div>
          </div>
        </a>
        <div
          class="cosmic-card"
          style="padding:10px 16px; background:rgba(16,185,129,0.15); border:2px solid var(--aurora-green); border-radius:10px;"
        >
          <div style="display:flex; align-items:center; gap:8px;">
            <span style="font-size:14px;">ğŸ•’</span>
            <div>
              <div class="tech-font" style="color:var(--comet-silver); font-size:10px;">OPEN</div>
              <div
                class="alien-font"
                style="color:var(--aurora-green); font-size:12px; font-weight:600;"
                id="header-status"
              >
                9AM - 9PM
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Real-time status update
    function updateHeaderStatus() {
      const now = new Date();
      const hour = now.getHours();
      const statusElement = document.getElementById('header-status');
      if (statusElement) {
        if (hour >= 9 && hour < 21) {
          statusElement.textContent = 'OPEN NOW';
          statusElement.style.color = 'var(--aurora-green)';
        } else {
          statusElement.textContent = '9AM - 9PM';
          statusElement.style.color = 'var(--solar-orange)';
        }
      }
    }
    updateHeaderStatus();
    setInterval(updateHeaderStatus, 60000);

    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const headerNav = document.getElementById('main-nav');
    const mobileToggle = document.querySelector('.mobile-menu-toggle');
    const menuText = document.getElementById('menu-text');
    let mobileMenuOpen = false;

    function handleResize() {
      if (window.innerWidth <= 950) {
        if (mobileToggle) mobileToggle.style.display = 'block';
        // Only show the menu if user has opened it
        if (headerNav) headerNav.style.display = mobileMenuOpen ? 'flex' : 'none';
      } else {
        if (mobileToggle) mobileToggle.style.display = 'none';
        if (headerNav) headerNav.style.display = 'flex';
        mobileMenuOpen = false; // reset mobile menu state when on desktop
        if (menuText) menuText.textContent = 'Menu'; // reset text when returning to desktop
      }
    }
    window.addEventListener('resize', handleResize);
    handleResize();

    if (mobileMenuBtn && headerNav) {
      mobileMenuBtn.addEventListener('click', () => {
        mobileMenuOpen = !mobileMenuOpen;
        headerNav.style.display = mobileMenuOpen ? 'flex' : 'none';
        mobileMenuBtn.setAttribute('aria-expanded', mobileMenuOpen.toString());

        // Update button text based on menu state
        if (menuText) {
          menuText.textContent = mobileMenuOpen ? 'Close' : 'Menu';
        }
      });
    }

    // Hover effects
    document.querySelectorAll('.nav-link').forEach((link) => {
      link.addEventListener('mouseenter', function () {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(6,182,212,0.4)';
      });
      link.addEventListener('mouseleave', function () {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = 'none';
      });
    });

    // Mobile menu button hover effect
    if (mobileMenuBtn) {
      mobileMenuBtn.addEventListener('mouseenter', function () {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 6px 20px rgba(6,182,212,0.4)';
      });
      mobileMenuBtn.addEventListener('mouseleave', function () {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = 'none';
      });
    }

    document.querySelectorAll('.contact-link-premium').forEach((link) => {
      link.addEventListener('mouseenter', function () {
        const glowEffect = this.querySelector('.premium-glow-effect');
        if (glowEffect) glowEffect.style.opacity = '1';
        this.style.transform = 'scale(1.05)';
      });
      link.addEventListener('mouseleave', function () {
        const glowEffect = this.querySelector('.premium-glow-effect');
        if (glowEffect) glowEffect.style.opacity = '0';
        this.style.transform = 'scale(1)';
      });
    });
  </script>

  <style>
    @keyframes cosmic-rotate {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
    @keyframes float-cosmic {
      0%,
      100% {
        transform: translateY(0px) rotate(0deg);
      }
      50% {
        transform: translateY(-10px) rotate(5deg);
      }
    }
    @keyframes shimmer {
      0% {
        transform: translateX(-200%);
      }
      50% {
        transform: translateX(200%);
      }
      100% {
        transform: translateX(-200%);
      }
    }
    @keyframes nav-scan {
      0%,
      100% {
        transform: translateX(-100%);
      }
      50% {
        transform: translateX(100%);
      }
    }
    @keyframes emergencyPulse {
      0%,
      100% {
        opacity: 1;
      }
      50% {
        opacity: 0.8;
      }
    }
    .cosmic-glow {
      text-shadow:
        0 0 10px currentColor,
        0 0 20px currentColor,
        0 0 30px currentColor;
    }
    .space-button:hover {
      transform: translateY(-2px) !important;
      box-shadow: 0 6px 25px rgba(6, 182, 212, 0.5) !important;
    }
    .cta-primary {
      animation: pulse-glow 2s ease-in-out infinite;
      color: #ffffff !important;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }
    .cta-primary:hover {
      background: linear-gradient(45deg, #0d9668, #0891b2) !important;
      color: #ffffff !important;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }
    @keyframes pulse-glow {
      0%,
      100% {
        box-shadow: 0 0 5px rgba(16, 185, 129, 0.5);
      }
      50% {
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.8);
      }
    }
    @media (max-width: 1100px) {
      .header-toolbar {
        flex-direction: column !important;
        align-items: center !important;
        gap: 14px !important;
      }
      .header-nav {
        width: 100% !important;
        margin-top: 12px !important;
        display: none !important;
      }
      .logo-image-card,
      .brand-name-card {
        margin: 0 auto 8px auto !important;
        max-width: 215px !important;
        width: 100% !important;
        justify-content: center !important;
      }
      .mobile-menu-toggle {
        display: block !important;
        z-index: 10;
        align-self: center !important;
        margin: 8px auto 4px auto !important;
        text-align: center !important;
      }
      .nav-list {
        flex-direction: column !important;
        align-items: stretch !important;
        gap: 6px !important;
      }
      .nav-list li,
      .nav-list li a {
        width: 100% !important;
        justify-content: center !important;
        padding: 12px !important;
      }
      .header-nav[style*='display: flex'] {
        display: flex !important;
        flex-direction: column !important;
        align-items: stretch !important;
      }

      /* Center the contact info cards and keep them on same line */
      .header-toolbar > div:last-child {
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
        gap: 12px !important;
        width: 100% !important;
        flex-wrap: nowrap !important;
      }
    }
    @media (max-width: 768px) {
      .logo-image-card,
      .brand-name-card {
        max-width: 160px !important;
      }

      /* Ensure contact cards stay centered and on same line on smaller screens */
      .header-toolbar > div:last-child {
        flex-wrap: nowrap !important;
        justify-content: center !important;
        gap: 8px !important;
      }

      /* Make contact cards slightly smaller on very small screens if needed */
      .contact-link-premium,
      .cosmic-card {
        padding: 8px 12px !important;
        font-size: 12px !important;
      }
    }
  </style>
</header>
